<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù…Ù† Ù‡ÙˆØŸ - Ù„Ø¹Ø¨Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ Ø§Ù„ØµÙÙŠ</title>
  
  <!-- Ø®Ø·ÙˆØ· Cairo -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  
  <!-- Canvas Confetti -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  
  <style>
    /* Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª ÙˆØ§Ù„Ù…ØªØºÙŠØ±Ø§Øª */
    :root {
      --primary-color: #4285f4;
      --secondary-color: #34a853;
      --accent-color: #fbbc04;
      --error-color: #ea4335;
      --text-color: #333;
      --bg-color: #f8f9fa;
      --white: #ffffff;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      --border-radius: 12px;
      --transition: all 0.3s ease;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Cairo', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: var(--text-color);
      line-height: 1.6;
      min-height: 100vh;
      direction: rtl;
      overflow-x: hidden;
    }

    /* Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
    .main-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      position: relative;
    }

    /* Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© */
    .back-button {
      position: fixed;
      top: 20px;
      left: 20px;
      background: var(--primary-color);
      color: var(--white);
      padding: 12px 20px;
      border-radius: 50px;
      text-decoration: none;
      font-weight: 600;
      box-shadow: var(--shadow);
      transition: var(--transition);
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .back-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
    }

    /* Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© */
    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: var(--white);
      padding: 3rem 2rem;
      border-radius: var(--border-radius);
      text-align: center;
      margin-bottom: 2rem;
      box-shadow: var(--shadow);
    }

    .header h1 {
      font-size: 3rem;
      font-weight: 800;
      margin-bottom: 1rem;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .header p {
      font-size: 1.2rem;
      opacity: 0.9;
    }

    /* Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ… */
    .controls {
      background: var(--white);
      padding: 2rem;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      margin-bottom: 2rem;
    }

    .control-group {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 1.5rem;
    }

    .control-group:last-child {
      margin-bottom: 0;
    }

    select, button {
      font-family: 'Cairo', sans-serif;
      font-size: 1.1rem;
      font-weight: 600;
      padding: 1rem 1.5rem;
      border: 2px solid #e0e0e0;
      border-radius: var(--border-radius);
      background: var(--white);
      transition: var(--transition);
      cursor: pointer;
      min-width: 200px;
    }

    select:focus, button:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.2);
    }

    button {
      background: var(--primary-color);
      color: var(--white);
      border-color: var(--primary-color);
    }

    button:hover {
      background: #3367d6;
      transform: translateY(-2px);
      box-shadow: var(--shadow);
    }

    button:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© */
    .game-area {
      background: var(--white);
      padding: 2rem;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      margin-bottom: 2rem;
      min-height: 400px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
    .message {
      padding: 1rem 1.5rem;
      border-radius: var(--border-radius);
      margin-bottom: 1rem;
      font-weight: 600;
      text-align: center;
    }

    .message.info {
      background: #e3f2fd;
      color: #1976d2;
      border: 1px solid #bbdefb;
    }

    .message.success {
      background: #e8f5e8;
      color: #2e7d32;
      border: 1px solid #c8e6c9;
    }

    .message.error {
      background: #ffebee;
      color: #c62828;
      border: 1px solid #ffcdd2;
    }

    .message.warning {
      background: #fff3e0;
      color: #ef6c00;
      border: 1px solid #ffcc02;
    }

    /* Ø§Ù„ØªØ¬Ø§ÙˆØ¨ÙŠØ© */
    @media (max-width: 768px) {
      .back-button {
        padding: 10px 16px;
        font-size: 0.9rem;
      }

      .header h1 {
        font-size: 2rem;
      }

      .header p {
        font-size: 1rem;
      }

      .control-group {
        flex-direction: column;
        align-items: center;
      }

      select, button {
        width: 100%;
        max-width: 300px;
      }

      .main-container {
        padding: 15px;
      }
    }

    /* Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
    .loading {
      display: none;
      text-align: center;
      padding: 2rem;
    }

    .loading.active {
      display: block;
    }

    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid var(--primary-color);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 1rem;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ù†Ø§ØµØ± */
    .hidden {
      display: none !important;
    }

    /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© */
    .game-interface {
      text-align: center;
    }

    .secret-popup {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: var(--white);
      padding: 2rem;
      border-radius: var(--border-radius);
      margin-bottom: 2rem;
      box-shadow: var(--shadow);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }

    .secret-name {
      font-size: 2rem;
      font-weight: 800;
      color: var(--accent-color);
      margin: 1rem 0;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      word-break: break-word;
      line-height: 1.2;
    }

    .manual-selection {
      background: #f8f9fa;
      padding: 2rem;
      border-radius: var(--border-radius);
      margin-bottom: 2rem;
      border: 2px dashed #ddd;
    }

    .manual-selection select {
      width: 100%;
      max-width: 400px;
      margin-top: 1rem;
    }

    .hint-box {
      background: linear-gradient(135deg, #4285f4 0%, #34a853 100%);
      color: var(--white);
      padding: 2rem;
      border-radius: var(--border-radius);
      margin-bottom: 2rem;
      font-size: 1.3rem;
      line-height: 1.6;
      box-shadow: var(--shadow);
    }

    .options-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin: 2rem 0;
    }

    .option-button {
      background: var(--white);
      border: 2px solid #e0e0e0;
      padding: 1rem;
      border-radius: var(--border-radius);
      cursor: pointer;
      transition: var(--transition);
      font-family: 'Cairo', sans-serif;
      font-weight: 600;
      font-size: 1rem;
      text-align: center;
      min-height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
      word-break: break-word;
      line-height: 1.3;
    }

    .option-button:hover {
      background: #f0f0f0;
      border-color: var(--primary-color);
      transform: translateY(-2px);
      box-shadow: var(--shadow);
    }

    .option-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .result-display {
      background: var(--secondary-color);
      color: var(--white);
      padding: 2rem;
      border-radius: var(--border-radius);
      margin: 2rem 0;
      font-size: 1.5rem;
      font-weight: 700;
      box-shadow: var(--shadow);
      animation: celebrate 1s ease-in-out;
    }

    @keyframes celebrate {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .game-actions {
      margin-top: 2rem;
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .countdown {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--error-color);
      margin: 1rem 0;
    }

    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„ØªØ¬Ø§ÙˆØ¨ÙŠØ© Ù„Ù„Ø¹Ø¨Ø© */
    @media (max-width: 768px) {
      .options-grid {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 0.8rem;
      }

      .option-button {
        padding: 0.8rem;
        font-size: 0.9rem;
        min-height: 70px;
      }

      .secret-name {
        font-size: 1.5rem;
      }

      .hint-box {
        font-size: 1.1rem;
        padding: 1.5rem;
      }

      .result-display {
        font-size: 1.2rem;
        padding: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <!-- Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© -->
  <a href="../main.html" class="back-button">
    <i class="fas fa-home"></i>
    <span>Ø§Ù„Ø£Ù†Ø´Ø·Ø©</span>
  </a>

  <div class="main-container">
    <!-- Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© -->
    <header class="header">
      <h1><i class="fas fa-question-circle"></i> Ù…Ù† Ù‡ÙˆØŸ</h1>
      <p>Ù„Ø¹Ø¨Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ù„ØªØ®Ù…ÙŠÙ† Ù‡ÙˆÙŠØ© Ø§Ù„Ø·Ù„Ø§Ø¨ Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„ØªÙ„Ù…ÙŠØ­Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©</p>
    </header>

    <!-- Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙƒÙ… -->
    <div class="controls">
      <div class="control-group">
        <select id="classSelect">
          <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>
        </select>
        
        <select id="modeSelect">
          <option value="random">ÙØ±Ø¯ÙŠ Ø¹Ø´ÙˆØ§Ø¦ÙŠ</option>
          <option value="manual">ÙØ±Ø¯ÙŠ Ø§Ù†ØªÙ‚Ø§Ø¦ÙŠ</option>
        </select>
      </div>
      
      <div class="control-group">
        <button id="startGameBtn" disabled>
          <i class="fas fa-play"></i> Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©
        </button>
      </div>
    </div>

    <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ -->
    <div id="messageArea"></div>

    <!-- Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
    <div class="loading" id="loadingArea">
      <div class="spinner"></div>
      <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
    </div>

    <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© -->
    <div class="game-area" id="gameArea">
      <p><i class="fas fa-info-circle"></i> Ø§Ø®ØªØ± Ø§Ù„ØµÙ ÙˆÙ†Ù…Ø· Ø§Ù„Ù„Ø¹Ø¨Ø© Ù„Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠ</p>
    </div>
  </div>

  <script>
    // Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
    class GameState {
      constructor() {
        this.studentData = null;
        this.currentClass = '';
        this.gameMode = '';
        this.targetStudent = '';
        this.allStudents = [];
        this.usedStudents = [];
        this.isLoading = false;
        this.stats = {
          gamesPlayed: 0,
          correctAnswers: 0,
          wrongAnswers: 0
        };
      }

      reset() {
        this.currentClass = '';
        this.gameMode = '';
        this.targetStudent = '';
        this.allStudents = [];
        this.usedStudents = [];
      }

      updateStats(isCorrect) {
        this.stats.gamesPlayed++;
        if (isCorrect) {
          this.stats.correctAnswers++;
        } else {
          this.stats.wrongAnswers++;
        }
      }

      getSuccessRate() {
        if (this.stats.gamesPlayed === 0) return 0;
        return Math.round((this.stats.correctAnswers / this.stats.gamesPlayed) * 100);
      }
    }

    // Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
    class MessageSystem {
      constructor() {
        this.container = document.getElementById('messageArea');
      }

      show(message, type = 'info', duration = 5000) {
        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
        this.clear();

        const messageEl = document.createElement('div');
        messageEl.className = `message ${type}`;
        messageEl.innerHTML = message;

        this.container.appendChild(messageEl);

        if (duration > 0) {
          setTimeout(() => {
            this.clear();
          }, duration);
        }

        return messageEl;
      }

      clear() {
        this.container.innerHTML = '';
      }
    }

    // Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„Ø¹Ø¨Ø©
    class WhoIsItGame {
      constructor() {
        this.state = new GameState();
        this.messages = new MessageSystem();
        this.init();
      }

      async init() {
        try {
          this.showLoading(true);
          await this.loadStudentData();
          this.setupEventListeners();
          this.showLoading(false);
          this.messages.show('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­', 'success');
        } catch (error) {
          this.showLoading(false);
          this.messages.show('âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
          console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©:', error);
        }
      }

      showLoading(show) {
        const loadingArea = document.getElementById('loadingArea');
        this.state.isLoading = show;
        
        if (show) {
          loadingArea.classList.add('active');
        } else {
          loadingArea.classList.remove('active');
        }
      }

      async loadStudentData() {
        const paths = [
          '../data/studentData.json',
          './data/studentData.json',
          'data/studentData.json'
        ];

        for (const path of paths) {
          try {
            const response = await fetch(path);
            if (response.ok) {
              const data = await response.json();
              if (data && typeof data === 'object') {
                this.state.studentData = data;
                this.populateClassSelect();
                return;
              }
            }
          } catch (error) {
            continue;
          }
        }

        throw new Error('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
      }

      populateClassSelect() {
        const classSelect = document.getElementById('classSelect');
        const startBtn = document.getElementById('startGameBtn');
        
        classSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>';

        const classes = Object.keys(this.state.studentData).sort();
        classes.forEach(className => {
          const studentCount = this.state.studentData[className].length;
          const option = document.createElement('option');
          option.value = className;
          option.textContent = `${className} (${studentCount} Ø·Ø§Ù„Ø¨)`;
          classSelect.appendChild(option);
        });

        // ØªÙØ¹ÙŠÙ„ Ø²Ø± Ø§Ù„Ø¨Ø¯Ø¡ Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙ
        classSelect.addEventListener('change', () => {
          startBtn.disabled = !classSelect.value;
          
          // Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø¹Ù† Ø§Ù„ØµÙ Ø§Ù„Ù…Ø®ØªØ§Ø±
          if (classSelect.value) {
            const studentCount = this.state.studentData[classSelect.value].length;
            this.messages.show(`ğŸ“š ØªÙ… Ø§Ø®ØªÙŠØ§Ø± "${classSelect.value}" - ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ${studentCount} Ø·Ø§Ù„Ø¨`, 'info', 3000);
          }
        });
      }

      setupEventListeners() {
        const startBtn = document.getElementById('startGameBtn');
        startBtn.addEventListener('click', () => this.startGame());
      }

      startGame() {
        const classValue = document.getElementById('classSelect').value;
        const modeValue = document.getElementById('modeSelect').value;

        if (!classValue || !modeValue) {
          this.messages.show('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙ ÙˆÙ†Ù…Ø· Ø§Ù„Ù„Ø¹Ø¨Ø©', 'warning');
          return;
        }

        this.state.currentClass = classValue;
        this.state.gameMode = modeValue;
        this.state.allStudents = this.state.studentData[classValue] || [];

        if (this.state.allStudents.length === 0) {
          this.messages.show('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØµÙ Ø§Ù„Ù…Ø­Ø¯Ø¯', 'error');
          return;
        }

        this.messages.show(`ğŸ® ØªÙ… Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©! Ø§Ù„ØµÙ: ${classValue} - Ø§Ù„Ù†Ù…Ø·: ${modeValue === 'random' ? 'Ø¹Ø´ÙˆØ§Ø¦ÙŠ' : 'Ø§Ù†ØªÙ‚Ø§Ø¦ÙŠ'}`, 'success');
        
        // ØªØ­Ø¯ÙŠØ« Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
        this.updateGameArea();
      }

      updateGameArea() {
        const gameArea = document.getElementById('gameArea');
        
        if (this.state.gameMode === 'random') {
          this.startRandomMode();
        } else {
          this.startManualMode();
        }
      }

      startRandomMode() {
        // Ø§Ø®ØªÙŠØ§Ø± Ø·Ø§Ù„Ø¨ Ø¹Ø´ÙˆØ§Ø¦ÙŠ
        const availableStudents = this.state.allStudents.filter(
          student => !this.state.usedStudents.includes(student)
        );

        if (availableStudents.length === 0) {
          this.messages.show('ğŸ ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨! ÙŠÙ…ÙƒÙ†Ùƒ Ø¨Ø¯Ø¡ Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©.', 'info');
          this.resetGame();
          return;
        }

        const randomIndex = Math.floor(Math.random() * availableStudents.length);
        this.state.targetStudent = availableStudents[randomIndex];
        this.state.usedStudents.push(this.state.targetStudent);

        this.showSecretName();
      }

      startManualMode() {
        const gameArea = document.getElementById('gameArea');
        gameArea.innerHTML = `
          <div class="game-interface">
            <div class="manual-selection">
              <h3><i class="fas fa-hand-pointer"></i> Ø§Ø®ØªØ± Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨</h3>
              <p>Ø§Ø®ØªØ± Ø·Ø§Ù„Ø¨Ø§Ù‹ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„ÙŠØªÙ… Ø¥Ø®ÙØ§Ø¡ Ø§Ø³Ù…Ù‡ ÙˆØ¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠ</p>
              <select id="studentSelect">
                <option value="">-- Ø§Ø®ØªØ± Ø§Ù„Ø·Ø§Ù„Ø¨ --</option>
                ${this.state.allStudents.map(student => 
                  `<option value="${student}" title="${student}">${this.formatStudentName(student)}</option>`
                ).join('')}
              </select>
              <div class="game-actions">
                <button onclick="game.selectManualStudent()" disabled id="selectBtn">
                  <i class="fas fa-check"></i> ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±
                </button>
              </div>
            </div>
          </div>
        `;

        // ØªÙØ¹ÙŠÙ„ Ø²Ø± Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ø·Ø§Ù„Ø¨
        const studentSelect = document.getElementById('studentSelect');
        const selectBtn = document.getElementById('selectBtn');
        
        studentSelect.addEventListener('change', () => {
          selectBtn.disabled = !studentSelect.value;
        });
      }

      selectManualStudent() {
        const studentSelect = document.getElementById('studentSelect');
        const selectedStudent = studentSelect.value;

        if (!selectedStudent) {
          this.messages.show('âš ï¸ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø·Ø§Ù„Ø¨ Ø£ÙˆÙ„Ø§Ù‹', 'warning');
          return;
        }

        this.state.targetStudent = selectedStudent;
        this.messages.show(`âœ… ØªÙ… Ø§Ø®ØªÙŠØ§Ø± "${this.formatStudentName(selectedStudent)}"`, 'success');
        
        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙˆØ¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
        setTimeout(() => {
          this.startHintPhase();
        }, 1500);
      }

      showSecretName() {
        const gameArea = document.getElementById('gameArea');
        const formattedName = this.formatSecretName(this.state.targetStudent);
        
        gameArea.innerHTML = `
          <div class="game-interface">
            <div class="secret-popup">
              <h3><i class="fas fa-eye"></i> Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø³Ø±ÙŠ</h3>
              <p>Ø§Ù†ØªØ¨Ù‡ Ø¬ÙŠØ¯Ø§Ù‹! Ø³ÙŠØ®ØªÙÙŠ Ø§Ù„Ø§Ø³Ù… Ø®Ù„Ø§Ù„ 3 Ø«ÙˆØ§Ù†Ù</p>
              <div class="secret-name">${formattedName}</div>
              <div class="countdown" id="countdown">3</div>
            </div>
          </div>
        `;

        // Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
        let timeLeft = 3;
        const countdownEl = document.getElementById('countdown');
        
        const timer = setInterval(() => {
          timeLeft--;
          if (timeLeft > 0) {
            countdownEl.textContent = timeLeft;
          } else {
            clearInterval(timer);
            this.startHintPhase();
          }
        }, 1000);

        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø­ØªÙØ§Ù„ Ø¨Ø§Ù„ÙƒÙˆÙ†ÙÙŠØªÙŠ
        this.celebrateSelection();
      }

      startHintPhase() {
        const gameArea = document.getElementById('gameArea');
        const hint = this.generateHint();
        
        gameArea.innerHTML = `
          <div class="game-interface">
            <div class="hint-box">
              <h3><i class="fas fa-lightbulb"></i> Ø§Ù„ØªÙ„Ù…ÙŠØ­</h3>
              <p>${hint}</p>
            </div>
            <div class="options-grid" id="optionsGrid">
              ${this.generateOptions().map((student, index) => 
                `<button class="option-button" onclick="game.checkAnswer('${student}', this)">
                  <i class="fas fa-user"></i> ${this.formatStudentName(student)}
                </button>`
              ).join('')}
            </div>
          </div>
        `;

        this.messages.show('ğŸ¯ Ø§Ø®ØªØ± Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø°ÙŠ ÙŠØ·Ø§Ø¨Ù‚ Ø§Ù„ØªÙ„Ù…ÙŠØ­!', 'info');
      }

      generateHint() {
        const hints = [
          "ğŸ† Ù‡Ø°Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨ ÙŠØ´Ø¬Ù‘Ø¹ Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯ Ø­ØªÙ‰ Ø£Ø«Ù†Ø§Ø¡ Ø´Ø±Ø­ Ø§Ù„Ø¯Ø±Ø³!",
          "ğŸ’™â¤ï¸ ÙŠØ¹Ø´Ù‚ Ø¨Ø±Ø´Ù„ÙˆÙ†Ø© ÙˆÙŠØ¯Ø§ÙØ¹ Ø¹Ù†Ù‡Ø§ ÙˆÙƒØ£Ù†Ù‡Ø§ Ù…Ù†ØªØ®Ø¨ Ø¨Ù„Ø§Ø¯Ù‡!",
          "ğŸ“š Ø¯Ø§Ø¦Ù…Ø§Ù‹ ÙŠØ¬Ù„Ø³ ÙÙŠ Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ ÙˆÙƒØ£Ù†Ù‡ Ø§Ù„Ù…Ø¹Ù„Ù… Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯!",
          "ğŸ˜‚ Ø¶Ø­ÙƒØªÙ‡ Ù…Ø¹Ø¯ÙŠØ© ÙˆØªÙ…Ù„Ø£ Ø§Ù„ÙØµÙ„ Ø­ØªÙ‰ ÙÙŠ Ø£ØµØ¹Ø¨ Ø§Ù„Ø­ØµØµ!",
          "âš¡ Ø¥Ø°Ø§ Ø³Ù…Ø¹ ÙƒÙ„Ù…Ø© 'ÙØ³Ø­Ø©' ÙŠØµØ¨Ø­ Ø£Ø³Ø±Ø¹ Ù…Ù† ÙÙ„Ø§Ø´!",
          "ğŸ¥ ÙŠØ´Ø±Ø­ Ø§Ù„Ø¯Ø±Ø³ ÙˆÙƒØ£Ù† Ù„Ø¯ÙŠÙ‡ Ù‚Ù†Ø§Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù…Ø´Ù‡ÙˆØ±Ø©!",
          "ğŸ¤·â€â™‚ï¸ ÙŠÙ†Ø³Ù‰ Ø£Ø¯ÙˆØ§ØªÙ‡ ÙƒÙ…Ø§ ÙŠÙ†Ø³Ù‰ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±... Ø¯Ø§Ø¦Ù…Ø§Ù‹!",
          "ğŸ“¢ ÙŠÙ†Ø§Ø¯ÙŠ Ø¹Ù„Ù‰ Ø£ØµØ¯Ù‚Ø§Ø¦Ù‡ Ù…Ù† Ø§Ù„Ù†Ø§ÙØ°Ø© ÙƒØ£Ù†Ù‡ Ù…Ø°ÙŠØ¹ Ø¥Ø°Ø§Ø¹ÙŠ!",
          "ğŸµ ÙŠØ­ÙØ¸ Ø§Ù„Ù†Ø´ÙŠØ¯ Ø§Ù„ÙˆØ·Ù†ÙŠ Ø£ÙØ¶Ù„ Ù…Ù† ÙˆØ²ÙŠØ± Ø§Ù„ØªØ¹Ù„ÙŠÙ…!",
          "ğŸƒâ€â™‚ï¸ ÙŠØ­Ø¨ Ø­ØµØ© Ø§Ù„Ø±ÙŠØ§Ø¶Ø© Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ù„Ø¹Ø·Ù„Ø© Ø§Ù„ØµÙŠÙÙŠØ©!",
          "â“ ÙŠØ³Ø£Ù„ Ø£Ø³Ø¦Ù„Ø© ÙƒØ«ÙŠØ±Ø© ÙˆÙƒØ£Ù†Ù†Ø§ ÙÙŠ Ø¨Ø±Ù†Ø§Ù…Ø¬ 'Ù…Ù† Ø³ÙŠØ±Ø¨Ø­ Ø§Ù„Ù…Ù„ÙŠÙˆÙ†'!",
          "ğŸ• ÙŠÙ†Ø³Ù‰ Ù‚Ù„Ù…Ù‡ ÙˆÙ„ÙƒÙ† Ù„Ø§ ÙŠÙ†Ø³Ù‰ ÙˆØ¬Ø¨ØªÙ‡ Ø£Ø¨Ø¯Ø§Ù‹!",
          "âš½ Ø¥Ø°Ø§ Ø±Ø£Ù‰ ÙƒØ±Ø© ÙŠÙ†Ø³Ù‰ Ø§Ù„Ù…Ø¹Ù„Ù… ÙˆØ§Ù„Ø¯Ø±Ø³ ÙˆØ§Ù„ÙƒÙˆÙ† ÙƒÙ„Ù‡!",
          "ğŸŒŸ ÙŠÙ…Ù„Ùƒ Ø£Ø¬Ù…Ù„ Ø§Ø¨ØªØ³Ø§Ù…Ø© ÙÙŠ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©... Ø¨Ù„ ÙÙŠ Ø§Ù„Ø­ÙŠ ÙƒÙ„Ù‡!",
          "ğŸ“Š ÙŠØ¹Ø±Ù Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¨Ø±Ø´Ù„ÙˆÙ†Ø© Ø£ÙØ¶Ù„ Ù…Ù† Ù…Ø¯Ø±Ø¨Ù‡Ù…!",
          "ğŸ¤” ÙŠÙÙƒØ± Ù…Ù„ÙŠÙ‘Ø§Ù‹ Ù‚Ø¨Ù„ ÙƒÙ„ Ø¥Ø¬Ø§Ø¨Ø© ÙˆÙƒØ£Ù† ÙƒÙ„ Ø³Ø¤Ø§Ù„ Ø§Ù…ØªØ­Ø§Ù† Ù†Ù‡Ø§Ø¦ÙŠ!",
          "ğŸ¤« ÙŠÙØ¶Ù„ Ø§Ù„Ø¹Ù…Ù„ Ø¨ØµÙ…Øª... Ù„ÙƒÙ† Ø¥Ù†Ø¬Ø§Ø²Ù‡ ÙŠØªÙƒÙ„Ù… Ø¹Ù†Ù‡!",
          "ğŸ‘‘ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù…Ø§ ÙŠØ·Ù…Ø­ Ø£Ù† ÙŠÙƒÙˆÙ† Ù‚Ø§Ø¦Ø¯ Ø§Ù„ÙØ±ÙŠÙ‚ ÙÙŠ ÙƒÙ„ Ù†Ø´Ø§Ø·!",
          "ğŸ•µï¸ ÙŠØ­Ù„Ù„ ÙƒÙ„ Ù…ÙˆÙ‚Ù ÙˆÙƒØ£Ù†Ù‡ Ù…Ø­Ù‚Ù‚ ÙÙŠ Ù…Ø³Ù„Ø³Ù„ Ø¨ÙˆÙ„ÙŠØ³ÙŠ!",
          "ğŸ“ Ù„Ø§ ÙŠØ­Ø¨ Ø§Ù„ÙÙˆØ¶Ù‰... Ø­ØªÙ‰ ÙÙŠ ØªØ±ØªÙŠØ¨ Ø£Ù‚Ù„Ø§Ù…Ù‡!",
          "â° ÙŠÙ†Ø¬Ø² ÙˆØ§Ø¬Ø¨Ø§ØªÙ‡ ÙÙŠ Ø§Ù„Ù„Ø­Ø¸Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø© ÙˆÙ„ÙƒÙ† Ø¨Ø¥ØªÙ‚Ø§Ù†!",
          "ğŸ¤ ÙŠØ³Ø§Ø¹Ø¯ Ø§Ù„Ø¬Ù…ÙŠØ¹ Ø­ØªÙ‰ Ù„Ùˆ Ù„Ù… ÙŠØ·Ù„Ø¨ Ù…Ù†Ù‡ Ø£Ø­Ø¯!",
          "ğŸ—£ï¸ ÙŠØªØ­Ø¯Ø« ÙƒØ«ÙŠØ±Ø§Ù‹... ÙˆØ¹Ù†Ø¯Ù…Ø§ ÙŠØµÙ…Øª Ù†Ø¹Ø±Ù Ø£Ù† Ù‡Ù†Ø§Ùƒ Ù…Ø´ÙƒÙ„Ø©!",
          "ğŸ¨ ÙŠØ­Ø¨ Ø§Ù„ØªÙ†Ø¸ÙŠÙ… ÙˆÙŠÙ„ÙˆÙ‘Ù† Ù…Ù„ÙØ§ØªÙ‡ ÙˆÙƒØ£Ù†Ù‡Ø§ Ù…Ø¹Ø±Ø¶ ÙÙ†ÙŠ!",
          "ğŸ’¬ ÙŠØ¹Ø¨Ø± Ø¹Ù† Ù…Ø´Ø§Ø¹Ø±Ù‡ Ø¨ÙˆØ¶ÙˆØ­... Ø­ØªÙ‰ Ù„Ùˆ ÙƒØ§Ù† ØºØ§Ø¶Ø¨Ø§Ù‹ Ù…Ù† Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†!",
          "ğŸŒŸ Ù‡Ø§Ø¯Ø¦ ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©... Ù„ÙƒÙ†Ù‡ Ù†Ø¬Ù… Ø³Ø§Ø·Ø¹ ÙÙŠ Ø§Ù„Ø£Ù†Ø´Ø·Ø©!",
          "ğŸš€ ÙŠØªØ­Ù…Ù‘Ø³ Ù„ØªØ¬Ø±Ø¨Ø© ÙƒÙ„ Ø´ÙŠØ¡ Ø¬Ø¯ÙŠØ¯ Ù‚Ø¨Ù„ Ø£Ù† ÙŠÙ‚Ø±Ø£ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª!",
          "ğŸ‘ï¸ ÙŠÙ„Ø§Ø­Ø¸ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØµØºÙŠØ±Ø© Ø§Ù„ØªÙŠ ÙŠØºÙÙ„ Ø¹Ù†Ù‡Ø§ Ø§Ù„Ø¢Ø®Ø±ÙˆÙ†!",
          "ğŸ­ Ø´Ø®ØµÙŠØªÙ‡ Ù…Ø±Ø­Ø© ÙˆÙ…Ù…ÙŠØ²Ø©... Ø§Ù„Ø¬Ù…ÙŠØ¹ ÙŠØªØ°ÙƒØ±Ù‡!"
        ];

        return hints[Math.floor(Math.random() * hints.length)];
      }

      generateOptions() {
        // Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ø®ÙŠØ§Ø±Ø§Øª ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù + 19 Ø·Ø§Ù„Ø¨ Ø¢Ø®Ø±
        const otherStudents = this.state.allStudents.filter(
          student => student !== this.state.targetStudent
        );
        
        // Ø§Ø®ØªÙŠØ§Ø± 19 Ø·Ø§Ù„Ø¨ Ø¹Ø´ÙˆØ§Ø¦ÙŠ
        const shuffledOthers = otherStudents.sort(() => 0.5 - Math.random());
        const selectedOthers = shuffledOthers.slice(0, 19);
        
        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù ÙˆØ®Ù„Ø· Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
        const allOptions = [...selectedOthers, this.state.targetStudent];
        return allOptions.sort(() => 0.5 - Math.random());
      }

      checkAnswer(selectedStudent, buttonElement) {
        // ØªØ¹Ø·ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
        const allButtons = document.querySelectorAll('.option-button');
        allButtons.forEach(btn => btn.disabled = true);

        if (selectedStudent === this.state.targetStudent) {
          this.handleCorrectAnswer(selectedStudent, buttonElement);
        } else {
          this.handleWrongAnswer(selectedStudent, buttonElement);
        }
      }

      handleCorrectAnswer(selectedStudent, buttonElement) {
        this.state.updateStats(true);
        
        buttonElement.style.background = '#4caf50';
        buttonElement.style.color = 'white';
        buttonElement.style.transform = 'scale(1.1)';

        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø­ØªÙØ§Ù„
        this.celebrateSuccess();

        // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©
        setTimeout(() => {
          this.showResult(true, selectedStudent);
        }, 2000);

        const successRate = this.state.getSuccessRate();
        this.messages.show(`ğŸ‰ Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­: ${successRate}%`, 'success');
      }

      handleWrongAnswer(selectedStudent, buttonElement) {
        this.state.updateStats(false);
        
        buttonElement.style.background = '#f44336';
        buttonElement.style.color = 'white';
        buttonElement.style.animation = 'shake 0.8s';

        const successRate = this.state.getSuccessRate();
        this.messages.show(`âŒ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰! Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­: ${successRate}%`, 'error');

        // Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ø®Ø±Ù‰ Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ†
        setTimeout(() => {
          const allButtons = document.querySelectorAll('.option-button');
          allButtons.forEach(btn => {
            if (btn !== buttonElement) {
              btn.disabled = false;
            }
          });
        }, 2000);
      }

      showResult(isCorrect, selectedStudent) {
        const gameArea = document.getElementById('gameArea');
        const formattedName = this.formatRevealedName(this.state.targetStudent);
        const stats = this.state.stats;
        
        gameArea.innerHTML = `
          <div class="game-interface">
            <div class="result-display">
              <h3>${isCorrect ? 'ğŸ‰ Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©!' : 'âŒ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©'}</h3>
              <p>Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ù…Ù‚ØµÙˆØ¯ Ù‡Ùˆ:</p>
              <div class="secret-name">${formattedName}</div>
              <div style="margin-top: 1rem; font-size: 1rem; opacity: 0.9;">
                ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª: ${stats.correctAnswers} ØµØ­ÙŠØ­ Ù…Ù† ${stats.gamesPlayed} Ù…Ø­Ø§ÙˆÙ„Ø© (${this.state.getSuccessRate()}%)
              </div>
            </div>
            <div class="game-actions">
              <button onclick="game.playAgain()">
                <i class="fas fa-redo"></i> Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
              </button>
              <button onclick="game.resetGame()">
                <i class="fas fa-home"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©
              </button>
            </div>
          </div>
        `;
      }

      playAgain() {
        if (this.state.gameMode === 'random') {
          this.startRandomMode();
        } else {
          this.startManualMode();
        }
      }

      resetGame() {
        this.state.reset();
        const gameArea = document.getElementById('gameArea');
        gameArea.innerHTML = `
          <p><i class="fas fa-info-circle"></i> Ø§Ø®ØªØ± Ø§Ù„ØµÙ ÙˆÙ†Ù…Ø· Ø§Ù„Ù„Ø¹Ø¨Ø© Ù„Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠ</p>
        `;
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¶ÙˆØ§Ø¨Ø·
        document.getElementById('classSelect').value = '';
        document.getElementById('modeSelect').value = 'random';
        document.getElementById('startGameBtn').disabled = true;
        
        this.messages.show('ğŸ”„ ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„Ø¹Ø¨Ø©', 'info');
      }

      // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªÙ†Ø³ÙŠÙ‚
      formatStudentName(fullName) {
        const parts = fullName.split(' ');
        if (fullName.length > 35) {
          if (parts.length >= 4) {
            return `${parts[0]} ${parts[1]} ... ${parts[parts.length - 1]}`;
          } else if (parts.length === 3) {
            return `${parts[0]} ... ${parts[parts.length - 1]}`;
          } else {
            return fullName.substring(0, 30) + '...';
          }
        } else if (fullName.length > 25) {
          if (parts.length >= 3) {
            return `${parts[0]} ... ${parts[parts.length - 1]}`;
          }
        }
        return fullName;
      }

      formatSecretName(fullName) {
        const parts = fullName.split(' ');
        if (parts.length > 6) {
          const firstLine = parts.slice(0, 2).join(' ');
          const secondLine = parts.slice(2, 4).join(' ');
          const thirdLine = parts.slice(4).join(' ');
          return `${firstLine}<br><span style="font-size: 0.9em;">${secondLine}</span><br><span style="font-size: 0.8em; opacity: 0.9;">${thirdLine}</span>`;
        } else if (parts.length > 4) {
          const midPoint = Math.ceil(parts.length / 2);
          const firstLine = parts.slice(0, midPoint).join(' ');
          const secondLine = parts.slice(midPoint).join(' ');
          return `${firstLine}<br><span style="font-size: 0.9em;">${secondLine}</span>`;
        } else if (fullName.length > 40) {
          const midPoint = Math.ceil(parts.length / 2);
          const firstLine = parts.slice(0, midPoint).join(' ');
          const secondLine = parts.slice(midPoint).join(' ');
          return `${firstLine}<br><span style="font-size: 0.9em;">${secondLine}</span>`;
        }
        return fullName;
      }

      formatRevealedName(fullName) {
        const parts = fullName.split(' ');
        if (parts.length > 6) {
          return `${parts[0]} ${parts[1]}<br><span style="font-size: 0.8em;">... ${parts[parts.length - 2]} ${parts[parts.length - 1]}</span>`;
        } else if (parts.length > 4) {
          const midPoint = Math.ceil(parts.length / 2);
          const firstLine = parts.slice(0, midPoint).join(' ');
          const secondLine = parts.slice(midPoint).join(' ');
          return `${firstLine}<br><span style="font-size: 0.9em;">${secondLine}</span>`;
        } else if (fullName.length > 35) {
          const midPoint = Math.ceil(parts.length / 2);
          const firstLine = parts.slice(0, midPoint).join(' ');
          const secondLine = parts.slice(midPoint).join(' ');
          return `${firstLine}<br><span style="font-size: 0.9em;">${secondLine}</span>`;
        }
        return fullName;
      }

      // Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¨ØµØ±ÙŠØ©
      celebrateSelection() {
        if (typeof confetti !== 'undefined') {
          confetti({
            particleCount: 100,
            spread: 70,
            origin: { y: 0.6 },
            colors: ['#4285f4', '#34a853', '#fbbc04', '#ea4335']
          });
        }
      }

      celebrateSuccess() {
        if (typeof confetti !== 'undefined') {
          // Ø§Ù†ÙØ¬Ø§Ø± Ù…ØªØ¹Ø¯Ø¯
          const count = 200;
          const defaults = {
            origin: { y: 0.7 }
          };

          function fire(particleRatio, opts) {
            confetti(Object.assign({}, defaults, opts, {
              particleCount: Math.floor(count * particleRatio)
            }));
          }

          fire(0.25, {
            spread: 26,
            startVelocity: 55,
          });
          fire(0.2, {
            spread: 60,
          });
          fire(0.35, {
            spread: 100,
            decay: 0.91,
            scalar: 0.8
          });
          fire(0.1, {
            spread: 120,
            startVelocity: 25,
            decay: 0.92,
            scalar: 1.2
          });
          fire(0.1, {
            spread: 120,
            startVelocity: 45,
          });
        }
      }
    }

    // Ù…ØªØºÙŠØ± Ø¹Ø§Ù… Ù„Ù„Ø¹Ø¨Ø©
    let game;

    // ØªØ´ØºÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    document.addEventListener('DOMContentLoaded', () => {
      game = new WhoIsItGame();
    });

    // Ø¥Ø¶Ø§ÙØ© CSS Ù„Ù„Ø­Ø±ÙƒØ§Øª
    const style = document.createElement('style');
    style.textContent = `
      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-10px); }
        75% { transform: translateX(10px); }
      }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html>
